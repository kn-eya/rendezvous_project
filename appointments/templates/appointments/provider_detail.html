{% extends "base.html" %}
{% block content %}

<style>
body {
    background: #f0f2f5;
    font-family: 'Poppins', sans-serif;
    color: #333;
    margin: 0;
    padding: 0;
}

/* --- CONTAINER --- */
.provider-card {
    max-width: 900px;
    margin: 50px auto;
    background: #ffffff;
    border-radius: 20px;
    box-shadow: 0 12px 30px rgba(0,0,0,0.1);
    overflow: hidden;
    padding: 35px;
}

/* --- HEADER --- */
.provider-header {
    text-align: center;
}
.provider-header img {
    width: 130px;
    height: 130px;
    border-radius: 50%;
    border: 4px solid #6c5ce7;
    object-fit: cover;
    margin-bottom: 15px;
}
.provider-header h2 {
    font-size: 2rem;
    margin-bottom: 5px;
}
.provider-header p {
    font-size: 1rem;
    color: #666;
}

/* --- SERVICES --- */
.provider-services {
    text-align: center;
    margin-top: 25px;
}
.provider-services h3 {
    font-size: 1.3rem;
    margin-bottom: 10px;
    color: #444;
}
.service-badge {
    display: inline-block;
    background: #6c5ce7;
    color: white;
    padding: 6px 14px;
    border-radius: 20px;
    margin: 4px 4px 4px 0;
    font-size: 0.9rem;
    font-weight: 500;
}

/* --- BOUTON R√âSERVATION --- */
.provider-book {
    text-align: center;
    margin-top: 30px;
}
.provider-book .btn-book {
    background: #00b894;
    color: #fff;
    font-weight: 600;
    padding: 12px 30px;
    border-radius: 30px;
    text-decoration: none;
    font-size: 1rem;
    transition: 0.3s;
}
.provider-book .btn-book:hover {
    background: #00a07f;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
}

/* --- GALERIE --- */
.provider-gallery {
    margin-top: 40px;
}
.provider-gallery h3 {
    font-size: 1.3rem;
    margin-bottom: 15px;
}
.gallery-filters {
    text-align: center;
    margin-bottom: 15px;
}
.filter-btn {
    border: none;
    background: #e0e0e0;
    padding: 7px 18px;
    border-radius: 25px;
    cursor: pointer;
    margin-right: 5px;
    font-size: 0.85rem;
    transition: 0.2s;
}
.filter-btn.active {
    background: #6c5ce7;
    color: #fff;
}
.gallery {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 12px;
}
.gallery img {
    width: 100%;
    border-radius: 15px;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
}
.gallery img:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

/* --- AVIS --- */
.provider-reviews {
    margin-top: 40px;
}
.provider-reviews h3 {
    font-size: 1.3rem;
    margin-bottom: 15px;
}
.review-card {
    background: #f8f9fb;
    padding: 15px 20px;
    border-radius: 15px;
    margin-bottom: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
}
.review-card .stars {
    color: #f1c40f;
    font-size: 0.9rem;
    margin-bottom: 5px;
}
.review-card p {
    font-size: 0.9rem;
    color: #555;
    margin: 2px 0;
}
</style>

<div class="provider-card">

    <!-- Header -->
    <header class="provider-header">
        {% if provider.photo %}
            <img src="{{ provider.photo.url }}" alt="{{ provider.user.username }}">
        {% else %}
            <img src="/static/default_profile.png" alt="{{ provider.user.username }}">
        {% endif %}
        <h2>{{ provider.user.username }}</h2>
        <p><strong>T√©l√©phone:</strong> {{ provider.phone }}</p>
    </header>

    <!-- Services -->
    <section class="provider-services">
        <h3>Services propos√©s:</h3>
        {% if provider.services.exists %}
            <p>
                {% for s in provider.services.all %}
                    <span class="service-badge">{{ s.name }}</span>
                {% endfor %}
            </p>
        {% else %}
            <p>Aucun service disponible</p>
        {% endif %}
    </section>

    <!-- Bouton R√©server -->
    <div class="provider-book">
        <a href="{% url 'appointments:book_appointment' provider.id %}" class="btn-book">üìÖ R√©server</a>
    </div>

    <!-- Galerie -->
    {% if provider.gallery.exists %}
    <section class="provider-gallery">
        <h3>üñºÔ∏è Galerie</h3>
        <div class="gallery-filters">
            <button class="filter-btn active" data-filter="all">Tous</button>
            <button class="filter-btn" data-filter="travail">Travail</button>
            <button class="filter-btn" data-filter="clients">Clients</button>
        </div>
        <div class="gallery">
            {% for photo in provider.gallery.all %}
                <img src="{{ photo.image.url }}" alt="Photo {{ forloop.counter }}" data-type="{{ photo.type }}">
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- Avis -->
    {% if provider.reviews.exists %}
    <section class="provider-reviews">
        <h3>‚≠ê Avis clients</h3>
        <div class="reviews-list">
            {% for r in provider.reviews.all %}
                <article class="review-card">
                    <p class="stars">{% for i in "12345"|slice:":r.rating" %}‚≠ê{% endfor %}</p>
                    <p>{{ r.comment }}</p>
                    <p><strong>{{ r.user.username }}</strong></p>
                </article>
            {% endfor %}
        </div>
    </section>
    {% endif %}

</div>

<script>
// Filtrer galerie
const filterBtns = document.querySelectorAll('.filter-btn');
const galleryImgs = document.querySelectorAll('.gallery img');

filterBtns.forEach(btn => {
    btn.addEventListener('click', () => {
        filterBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        const filter = btn.getAttribute('data-filter');

        galleryImgs.forEach(img => {
            img.style.display = (filter === 'all' || img.getAttribute('data-type') === filter) ? 'block' : 'none';
        });
    });
});
</script>

{% endblock %}
