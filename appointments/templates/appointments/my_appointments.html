{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container py-5">
    <h2 class="text-center text-white mb-4">üìÖ Mes Rendez-vous</h2>

    {% if appointments %}
        <div class="row g-4">
            {% for appointment in appointments %}
                <div class="col-md-6 col-lg-4">
                    <div class="card appointment-card shadow-lg h-100">
                        <div class="card-body">

                            <!-- Info prestataire -->
                            <div class="d-flex align-items-center mb-3">
                                <img src="{% static 'images/default-avatar.png' %}" class="rounded-circle me-3" width="60" height="60" alt="Prestataire">
                                <div>
                                    <h5 class="mb-0">{{ appointment.service.name }}</h5>
                                    {% if appointment.service.provider %}
                                        <small class="text-muted">üë§ {{ appointment.service.provider.username }}</small>
                                    {% else %}
                                        <small class="text-muted">üë§ Aucun prestataire</small>
                                    {% endif %}
                                    <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</div>
                                </div>
                            </div>

                            <!-- Date / Heure / Statut -->
                            <p><strong>Date :</strong> {{ appointment.date }}</p>
                            <p><strong>Heure :</strong> {{ appointment.time }}</p>
                            <p><strong>Statut :</strong>
                                {% if appointment.status == 'pending' %}
                                    <span class="badge bg-warning">En attente</span>
                                {% elif appointment.status == 'confirmed' %}
                                    <span class="badge bg-success">Confirm√©</span>
                                {% else %}
                                    <span class="badge bg-danger">Annul√©</span>
                                {% endif %}
                            </p>

                            <!-- Actions -->
                            <div class="d-flex justify-content-between mt-3">
                                <!-- Voir profil -->
                                {% if appointment.service.provider %}
                                    <a href="{% url 'appointments:provider_detail' appointment.service.provider.id %}" class="btn btn-outline-primary btn-sm">
                                        Voir profil
                                    </a>
                                {% else %}
                                    <button class="btn btn-outline-secondary btn-sm" disabled>Pas de prestataire</button>
                                {% endif %}

                                <!-- Annuler rendez-vous -->
                                {% if appointment.status != 'cancelled' %}
                                <form method="post" action="{% url 'appointments:cancel_appointment' appointment.id %}">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Annuler ce rendez-vous ?');">
                                        Annuler
                                    </button>
                                </form>
                                {% endif %}
                            </div>

                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-warning text-center">
            Aucun rendez-vous trouv√©.
        </div>
    {% endif %}
</div>

<style>
body {
    background: linear-gradient(135deg,#00b894,#6c5ce7);
}

.appointment-card {
    border-radius: 20px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.appointment-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 35px rgba(0,0,0,0.2);
}

.rating {
    color: #f1c40f;
    font-size: 14px;
}

.btn-outline-primary {
    border-color: #00b894;
    color: #00b894;
}

.btn-outline-primary:hover {
    background: #00b894;
    color: #fff;
}

.btn-outline-secondary {
    border-color: #6c757d;
    color: #6c757d;
}
</style>

{% endblock %}
